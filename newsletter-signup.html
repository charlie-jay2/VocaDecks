<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Join Newsletter</title>
    <style>
      * {
        box-sizing: border-box;
        padding: 0;
        margin: 0;
        font-family: "Poppins", sans-serif;
        font-size: 18px;
      }
      body {
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #222222;
        flex-direction: column; /* Stack the elements vertically */
      }
      .container {
        width: 500px;
        padding: 30px;
        border: 1px solid #eeeeee;
        border-radius: 10px;
        background: linear-gradient(180deg, #50dbcb, #ffef3d);
        margin-top: 20px; /* Space between logo and form */
        text-align: center;
      }
      h4 {
        margin-bottom: 10px;
        font-size: 24px;
        color: black;
      }
      input {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
      }
      #submit {
        border: none;
        background-color: #50dbcb;
        color: black;
        width: 200px;
        margin-top: 10px;
        border-radius: 5px;
        cursor: pointer;
        transition: 0.6s ease-in-out;
      }
      #submit:hover {
        background-color: #ffef3d;
        color: black;
      }
      img {
        max-width: 390px;
        display: block;
        margin-bottom: 0px; /* Space between the logo and the form */
      }
      .success-message {
        font-size: 20px;
        color: black;
        margin-top: 20px;
      }
      .additional-info {
        font-size: 16px;
        color: black;
        margin-top: 10px;
      }
      .error-message {
        font-size: 20px;
        color: red;
        margin-top: 20px;
        display: none;
      }
    </style>
  </head>
  <body>
    <img src="https://iili.io/3IAmUWF.png" alt="Vocadecks Logo" />
    <div class="container">
      <form method="post" action="" name="contact-form">
        <h4>Join our Newsletter</h4>
        <input type="text" name="your-name" placeholder="Name" required />
        <input type="email" name="your-email" placeholder="Email" required />
        <input type="submit" value="Submit" id="submit" />
      </form>
      <div class="success-message" style="display: none">
        Successfully joined the VocaDecks newsletter!
      </div>
      <div class="additional-info" style="display: none">
        Ensure you check your Inbox and Spam folder.
      </div>
      <div class="error-message">
        This email is already registered. Please use a different one.
      </div>
    </div>
    <script src="floatinghomebutton.js"></script>

    <script>
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbxrYMkAU11tPC6EZ5FGLqZORq0RHJ3kGONXnjPMc52QoXIuv4Kz6t9yPobKbHrzueql/exec";

      const form = document.forms["contact-form"];
      const submitButton = document.getElementById("submit");
      const successMessage = document.querySelector(".success-message");
      const additionalInfo = document.querySelector(".additional-info");
      const errorMessage = document.querySelector(".error-message");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Disable the submit button and instantly show success message
        submitButton.disabled = true;
        submitButton.style.backgroundColor = "#cccccc"; // Change color to indicate it's disabled
        submitButton.value = "Submitting..."; // Change the button text

        // Hide the form and clear previous messages
        form.style.display = "none";
        successMessage.style.display = "none";
        additionalInfo.style.display = "none";
        errorMessage.style.display = "none";

        // Show submitting text and wait for 2 seconds
        setTimeout(() => {
          successMessage.style.display = "none";
          additionalInfo.style.display = "none";
          errorMessage.style.display = "none"; // Hide error message initially
        }, 2000); // Wait 2 seconds before showing success message

        const formData = new FormData(form);
        const jsonData = {
          name: form["your-name"].value,
          email: form["your-email"].value,
        };

        try {
          // Send to Google Sheets
          const response = await fetch(scriptURL, {
            method: "POST",
            body: formData,
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            mode: "cors", // Add this line if not already set
          });
          const data = await response.json();

          if (data.result === "error") {
            // Show error message if email is already registered
            errorMessage.textContent = data.message;
            errorMessage.style.display = "block";
            submitButton.disabled = false;
            submitButton.style.backgroundColor = "#50dbcb"; // Reset color
            submitButton.value = "Submit"; // Reset button text
            form.style.display = "block"; // Show the form again
          } else {
            // Show success message
            successMessage.style.display = "block";
            additionalInfo.style.display = "block";
          }
        } catch (error) {
          console.error("Error!", error);
          alert("An error occurred. Please try again.");
          submitButton.disabled = false;
          submitButton.style.backgroundColor = "#50dbcb"; // Reset color
          submitButton.value = "Submit"; // Reset button text
          form.style.display = "block"; // Show the form again if there was an error
        }
      });
    </script>
  </body>
</html>
